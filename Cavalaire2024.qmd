---
title: "Cavalaire"
subtitle: |
  | Du 13 au 20 avril 2023
  |
  | *On fait la s√©cu ? Bon ben tu peux commencer √† t'√©quiper* --- Thomas √† Grom, 15 avril.
date: now
date-format: "dddd D MMMM YYYY"
lang: fr
title-block-banner: false
language:
  title-block-published: "Derni√®re Mise √† jour"
---

```{r}
#| include: false
library(tidyverse)
library(janitor)
library(kableExtra)
library(scales)

options(knitr.kable.NA = '')
```


```{r}
#| include: false

# Update this chunk every day

## Dive sites
sites <- c(	"L'Espingole", "Le Proph√®te", # Dimanche
			      "Le Togo", "Le Togo", # Lundi
			      "Le Ramon Membru", NA, # Mardi
			      NA, "Calanque de la Cron", # Mercredi
			      "Le Ramon Membru", "Calanque de la Cron", # Jeudi
			      "Le Rubis", "L'Espingole") # vendredi

## Who dived where ?
plongees <- tibble(
#			           Bap, Beu, Car, Gro, Nat, Ped, Tho, Ant, Val 
`Plong√©e 01` = c(  1,   1,   1,   1,   1,   1,   1,   0,   0),
`Plong√©e 02` = c(  0,   1,   1,   1,   1,   1,   1,   0,   0),
`Plong√©e 03` = c(  1,   1,   1,   1,   1,   1,   1,   1,   0),
`Plong√©e 04` = c(  0,   1,   1,   1,   1,   1,   1,   1,   0),
`Plong√©e 05` = c(  1,   1,   1,   1,   1,   0,   1,   1,   0),
`Plong√©e 06` = c(  0,   0,   0,   0,   0,   0,   0,   0,   0),
`Plong√©e 07` = c(  0,   0,   0,   0,   0,   0,   0,   0,   0),
`Plong√©e 08` = c(  0,   1,   0,   1,   1,   1,   1,   0,   0),
`Plong√©e 09` = c(  1,   1,   1,   1,   1,   1,   1,   1,   0),
`Plong√©e 10` = c(  0,   1,   0,   1,   0,   1,   1,   1,   0),
`Plong√©e 11` = c(  0,   1,   1,   1,   1,   1,   1,   1,   0),
`Plong√©e 12` = c(  0,   1,   1,   1,   1,   1,   1,   1,   0)
)

## Who spent what (only for dives and only for members!)
depenses <- tribble(
  ~Qui, ~`Essence bateau`, ~`Essence compresseurs`, ~Port, ~Gaz, ~Divers,
  "bap" , 0,  0,  0,  0, 0,
  "beu" , 77.40,  0,  0,  0, 49.49,  # Courroies compresseur
  "car" , 0,  0,  0,  140, 0,
  "grom", 77.43,  0,  0,  0, 0,
  "nat" , 77.32,  0,  69.5,  0, 0,
  "ped" , 150+100.42,  0,  0,  0, 0,
  "tho" , 0,  38.60,  0,  0, 21.98) # Tuyau arrosage

## Who spent what (one line per diver, members or not, for everything not dive-related)
autres <- tribble(
 ~Qui,  ~Logement, ~Nourriture, ~Carburant, ~Peages, ~Navette, ~Diver,
  "bap" ,  0,  0,  178,  95,  0,  0,
  "beu" ,  0,  142,  69.12+66.96+114.67,  51.8+16.8+7.3,  0,  0,
  "car" ,  0,  6.75+9.45+10.5+10.8+12,  141.38,  0,  0,  0,
  "grom",  980,  52.37+3.8+6.67,  0,  24.1+6.4,  0,  0,
  "nat" ,  0,  258.01+32.31,  78.18+96+68.71,  51.8+4+24.1+4.4+6.4+9.7,  0,  0,
  "Ped" ,  0,  142.59+22+11.9+7.22+100+17.80,  100,  34.1+4.9+11.20,  0,  0,
  "tho" ,  0,  0,  0,  3.9+34.1+4.9+15.6+3.7+2.5+2.6,  0,  0,
  "ant" ,  0,  0,  125,  0,  0,  0,
  "val" ,  0,  0,  0,  0,  0,  0)
```


```{r}
#| include: false

# Update once for every diving trip

## List of members
membres <- c("Bap", "Beu", "Carole", "Grom", "Nat", "Ped", "Thomas")
membres.full <- c("Baptiste", "Beno√Æt", "Carole", "J√©r√¥me", "Nathalie", "Pierre", "Thomas")

## List of guests
invites <- c("Ant", "Val")
invites.full <- c("Anthony", "Val√©rianne")

## For each diver, how many people in charge (divers + non-divers included)
famille <- c(1, 1, 1, 2, 1, 2, 1, 1, 2)

## For each diver, how many nights and meals
nuitees <- c(6, 7, 7, 14, 7, 14, 7, 6, 8)
repas <- nuitees * 3

## Total number of people including non divers
nb.pers <- sum(famille)

## Diving days
first.day <- "14-04-2024"
last.day <-  "19-04-2024"

## Runtime for the Yamaha
start.hours <- 812.1
end.hours <- 822.0

## Volume of fuel used
vol.fuel <- 150
conso.fuel <- 131.9
dist <- 62.6 # Nautic miles

## Cost for guest
dive.guest <- 26

## Overhead of diving Cost
overhead <- 3 # ‚Ç¨

source("computations.R")
```


----

## Plongeurs pr√©sents

Membres : `r membres.full`  
Invit√©s : `r invites.full`

## Les plong√©es

```{r}
#| echo: false
#| label: tbl-plongee
#| tbl-cap: "R√©capitulatif des plong√©es effectu√©es"

beautify_table(liste_plongees)
```

Au total, `r liste_plongees |> pull(Total) |> sum()` plong√©es ont √©t√© effectu√©es.

## Les d√©penses "plong√©e"

Les d√©penses entrant dans le calcul du co√ªt des plong√©es sont d√©taill√©s dans le tableau ci-dessous.

```{r}
#| echo: false
#| tbl-cap: "D√©penses engag√©es par les membres de l'AP"
#| label: tbl-dep_plong

beautify_cost_table(depenses)
```

Ici, les d√©penses de la rubrique "divers" concernent l'achat d'un nouveau tuyau d'arrosage pour le rin√ßage du mat√©riel ainsi que de 2 courroies neuves pour le compresseur rouge.


## Co√ªt des plong√©es


Le co√ªt d'une plong√©e est calcul√© en divisant la somme des d√©penses effectu√©es durant le s√©jour (ici, `r depenses |> pull(Total) |> sum()`‚Ç¨) par le nombre total de plong√©es effectu√©es durant le s√©jour (ici, `r liste_plongees |> pull(Total) |> sum()` plong√©es). Pour cette sortie, le co√ªt d'une plong√©e pour les membres de l'AP est de `r cout_membres - overhead`‚Ç¨. Toutefois, afin d'anticiper sur la r√©vision annuelle du moteur, nous avons d√©cid√© de majorer chaque plong√©e de `r overhead`‚Ç¨. Ainsi, **pour les membres, la plong√©e co√ªte `r cout_membres`‚Ç¨**.

Pour les invit√©s, le prix de la plong√©e est fix√© √† `r cout_guest - overhead`‚Ç¨ si la plong√©e des membres co√ªte moins cher. Sinon, tout le monde paie le m√™me prix. La m√™me majoration de `r overhead`‚Ç¨ est appliqu√©e pour les invit√©s, soit un prix de `r cout_guest`‚Ç¨ par plong√©e.

Au total, pour les plong√©es uniquement, chaque plongeur doit les sommes suivantes √†  l'AP :

```{r}
#| echo: false
#| tbl-cap: "Montants d√ªs pour la plong√©e"
#| label: tbl-cout_plongee

cout_plongee |> 
  select(Plongeur, Cout) |> 
  pivot_wider(names_from = Plongeur, values_from = Cout) |> 
  beautify_cost_table(total = FALSE)
```

## Les d√©penses "hors plong√©e"

Pour cette sortie, les d√©penses n'entrant pas dans le prix des plong√©es et la liste des payeurs sont pr√©sent√©s dans le tableau @tbl-cout_hors_plongee. Pour chaque plongeur (et sa famille), les nombres de nuit√©es et de repas pris au cours du s√©jours sont indiqu√©s dans le tableau @tbl-nights_and_food :

```{r}
#| echo: false
#| tbl-cap: "D√©penses hors plong√©es engag√©es par les participants √†  la sortie"
#| label: tbl-cout_hors_plongee

beautify_cost_table(autres)
```

Ici, les d√©penses de la rubrique "divers" concernent l'achat d'une bombe de WD40 et le "remerciement" du m√©cano de Cavalaire pour son coup de main avec le roulement de la remorque.


```{r}
#| echo: false
#| tbl-cap: "Nombre de nuit√©es et de repas"
#| label: tbl-nights_and_food

beautify_table(nr, total = FALSE)
```

Pour chaque **personne** (plongeur ou non), le co√ªt d'une nuit√©e, d'un repas et du transport s'√©l√®vent √†  :

```{r}
#| echo: false
#| tbl-cap: "Co√ªts unitaires par personne"
#| label: tbl-other_per_person

beautify_cost_table(autres_unit, total = FALSE)
```

## Bilan et remboursement

Au final, chaque **plongeur** doit donc les sommes suivantes

```{r}
#| echo: false
#| tbl-cap: "Bilan des co√ªts par plongeur et par poste"
#| label: tbl-cost_per_diver

beautify_cost_table(cout_all)
```

Compte tenu des sommes d√©j√†  engag√©es, les remboursements √† effectuer sont les suivants :

```{r}
#| echo: false

beautify_cost_table(rembourse, total = FALSE)
```


## B√©n√©fices, essence et heures

La majoration de `r overhead`‚Ç¨ de chaque plong√©e ainsi que les plong√©es des invit√©s (si la plong√©e des membres co√ªte moins de `r dive.guest-overhead`‚Ç¨) permettent de faire des (petits) b√©n√©fices. Ils s'√©l√®vent ici √† **`r benef`‚Ç¨**.

Pour finir, nous avons parcouru `r dist` milles nautiques. √áa veut dire que nous consommons en moyenne `r round(conso.fuel/dist, 2)` litres par mille, soit `r round(conso.fuel/dist/1.852, 2)` litres au kilom√®tre, soit la bagatelle de `r 100 * round(conso.fuel/dist/1.852, 2)` litres au 100 kilom√®tres. La plong√©e est un sport √©cologique !

<!-- Le moteur a tourn√© `r end.hours-start.hours` heures et `r vol.fuel` litres de sans plomb ont √©t√© mis dans le r√©servoir. D'apr√®s la console, `r conso.fuel` litres ont √©t√© consomm√©s soit une consommation moyenne de `r round(conso.fuel/(end.hours-start.hours),2)` litres √† l'heure. Il devrait donc rester environ `r vol.fuel-conso.fuel` litres dans le r√©servoir. Thomas en a sorti environ 70 litres, soit `r vol.fuel-conso.fuel - 70` litres de moins que pr√©vu. Cela repr√©sente une erreur d'estimation de consommation de `r round((vol.fuel - conso.fuel - 70) * 100 / (vol.fuel), 2)`%. Les boudins n'ont toujours pas √©t√© nettoy√©s : le savon sp√©cial est dans la console et le balais brosse dans le Ducato : avis aux amateurs ! -->


## Pour m√©moire

Nous avons log√© au [690, avenue de la Castillane](https://www.google.fr/maps/place/690+Av.+de+la+Castillane,+83240+Cavalaire-sur-Mer/@43.1799155,6.5186244,17z/data=!3m1!4b1!4m6!3m5!1s0x12cec) ([Description de la location sur Le Bon Coin](https://www.leboncoin.fr/locations_saisonnieres/1489618857.htm)). Maison tr√®s sympa avec piscine (pas chaude, mais pratique pour rep√©rer les fuites dans les combis √©tanches...), terrasse, gazon synth√©tique, et une grande all√©e en pente pour garer jusqu'√† 4 v√©hicules. √Ä environ 5 minutes du port de Cavalaire. Il y a 2 chambres doubles avec SDB au RDC. Possibilit√© de mettre un matelas dans chaque chambre. √Ä l'√©tage, une chambre double et un "dortoir" avec jusqu'√† 4 places (3 personnes id√©alement). Pi√®ce de vie agr√©able et location bon march√© : une bonne adresse √† conserver.

Comme d'habitude, les remorques (bateau et compresseurs) sont rest√©es sur le port toute la semaine. C√¥t√© plong√©es, c'est plut√¥t pas mal en d√©pit d'une m√©t√©o (tr√®s) p√©nible. Beaucoup (BEAUCOUP) de vent. Nous avons √©t√© tranquilles le dimanche et le vendredi matin. Le reste du temps, vent tr√®s violent en rafales (jusqu'√† 150 km/h enregistr√©s dans le Var), d'o√π les plong√©es r√©p√©t√©es sur le Ramon Membru et dans la Calanque de la Cron (sables et posidonies dans 10 m√®tres d'eau √† peine...). La visi √©tait globalement moyenne (assez laiteuse la plupart du temps), mais nous avons quand m√™me vu de belles choses : banc de s√©rioles, Saint Pierre, baracuda solitaire, s√®che, poulpes, homards, m√©rous, dorades... et m√™me un espadon a √©t√© aper√ßu en surface.

Cette sortie a aussi √©t√© marqu√©e par les d√©buts en recycleur de Grom, Baptiste et Beno√Æt. Beaucoup de bricolage et d'ajustements de configs, qui se finissaient souvent √† la frontale. Mais les probl√®mes se r√®glent petits √† petit, et les configs se peaufinent plong√©e apr√®s plong√©e. Et Grom a retrouv√© du temps de plong√©e et 2 plong√©es par jour üëç Nous avons aussi b√©n√©fici√© d'une commande de B50 d'oxy achet√©e √† Gwen. Le bateau a √©t√© sorti de l'eau le vendredi soir (nuit√©e sur le chantier nautic) et tout le matos a √©t√© rinc√© sur le port.

Derni√®re chose, il reste environ 70 litres de SP 95 dans les bidons. Ils seront utilis√©s cet √©t√©, √ßa sera √ßa de moins √† payer en juillet !

Au final, est-ce que √ßa nous a plu ? Poser la question, c'est d√©j√† la r√©pondre !


## Quelques graphiques

```{r}
#| echo: false
#| label: fig-plong
#| fig-cap: "Plongeurs √† bord du Valiant lors de chaque plong√©e"
#| fig-asp: 0.4

pl1
```

```{r}
#| echo: false
#| label: fig-dep
#| fig-cap: "Proportion des d√©penses par poste, pour la plong√©e et le reste"

pl2
```

```{r}
#| echo: false
#| label: fig-all
#| fig-cap: "Proportion des d√©penses de la sortie, tous postes confondus"
#| fig-asp: 0.618

pl3
```

